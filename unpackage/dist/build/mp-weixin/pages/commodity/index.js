(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/commodity/index"],{"0eca":function(e,t,n){},2997:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i,u=c(n("a34a")),r=c(n("9f7c")),o=c(n("7da1"));function c(e){return e&&e.__esModule?e:{default:e}}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t,n,i,u,r,o){try{var c=e[r](o),a=c.value}catch(s){return void n(s)}c.done?t(a):Promise.resolve(a).then(i,u)}function d(e){return function(){var t=this,n=arguments;return new Promise((function(i,u){var r=e.apply(t,n);function o(e){s(r,i,u,o,c,"next",e)}function c(e){s(r,i,u,o,c,"throw",e)}o(void 0)}))}}var l=function(){n.e("my_common_components/Tabbar").then(function(){return resolve(n("b7b6"))}.bind(null,n)).catch(n.oe)},f={components:{Tabbar:l},data:function(){return{name:"",activeColor:"#D0021B",checkedNum:0,allChecked:!1,day3After:new Date(new Date((new Date).toLocaleDateString()).getTime()+2592e5-1).valueOf(),list:[],inquiryShow:!1,inquiryForm:{currency:"",price:"",validity:"",day:"",trend:"",pricetrendValue:"",explain:"",remark:""},rules1:{currency:[{required:!0,message:"请选择币种",trigger:["change","blur"]}],price:[{trigger:["blur","change"],required:!0,validator:function(e,t,n){var i=/^[+]{0,1}(\d+)$|^[+]{0,1}(\d+\.\d+)$/;i.test(t)?n():n(new Error("请输入准确的价格"))}}],validity:[{required:!0,message:"请选择有效期",trigger:["change"]}],day:[{required:!0,type:"number",message:"请填写正确的交货天数",trigger:["change"]}]},selectPriceTrendShow:!1,selectPriceTrendList:[{value:"1",label:"上升"},{value:"2",label:"平稳"},{value:"3",label:"下降"}],selectTypesCurrencyShow:!1,selectTypesCurrencyList:[{value:"1",label:"CNY"},{value:"2",label:"USD"}],dateTime:!1,params:{year:!0,month:!0,day:!0,hour:!0,minute:!0},defaultTime:(0,o.default)().format("YYYY-MM-DD HH:mm:ss"),commodityInfo:{spuId:"",spuName:"",skuId:"",spuSpec:"",unit:""},checkedList:[]}},created:function(){this.getSupplierProduct()},onReady:function(){this.$refs.iForm1.setRules(this.rules1)},methods:(i={getSupplierProduct:function(){var t=this;return d(u.default.mark((function n(){var i;return u.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,(0,r.default)(t.api.v2.supplier_product,{method:"get",data:{accessToken:e.getStorageSync("accessToken"),keyword:t.name}});case 2:i=n.sent,"0"===i.data.code&&(t.list=i.data.data,t.list.length>0&&t.list.forEach((function(e,n){e.checked=!1,e.down=!1,e.name=n,e.id=n,e.currency="CNY",e.isGray=new Date(e.expiredDate).getTime()<+new Date,e.day3After=(new Date).valueOf()<new Date(e.expiredDate).getTime()&&new Date(e.expiredDate).getTime()<t.day3After})));case 4:case"end":return n.stop()}}),n)})))()},checkboxAllChange:function(){this.allChecked?this.list.map((function(e){e.checked=!0})):this.list.map((function(e){e.checked=!1})),this.checkedNum=this.list.filter((function(e){return e.checked})).length,this.checkedList=this.list.filter((function(e){return e.checked})),this.$forceUpdate()},checkboxOneChange:function(e){this.allChecked=this.list.length===this.list.filter((function(e){return e.checked})).length,this.checkedNum=this.list.filter((function(e){return e.checked})).length,this.checkedList=this.list.filter((function(e){return e.checked})),this.$forceUpdate()},batchFilling:function(){e.navigateTo({url:"../batchQuotation/index"})},toSoonExpire:function(){e.setStorageSync("day3AfterList",this.day3AfterList),this.day3AfterList.length>0?e.navigateTo({url:"../soonExpire/index"}):this.$refs.toast.show({title:"暂无3天内即将过期的商品",type:"error",position:"top"})},checkedAll:function(){this.getSupplierProduct()},changeCurrency:function(e){return"USD"===e.currency?(e.currency="CNY",void this.$forceUpdate()):"CNY"===e.currency?(e.currency="USD",void this.$forceUpdate()):void 0},showInquiryModalCancel:function(){this.resetInquiryForm(),this.inquiryShow=!1},showInquiryModal:function(e){this.resetInquiryForm(),this.inquiryShow=!0,this.commodityInfo={spuId:e.spuId,spuName:e.spuName,skuId:e.skuId,spuSpec:e.spuSpec,unit:e.unit}},submitBidding:function(){var t=this;return d(u.default.mark((function n(){return u.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:t.$refs.iForm1.validate(function(){var n=d(u.default.mark((function n(i){var o;return u.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!i){n.next=6;break}return n.next=3,(0,r.default)(t.api.v2.submitProduct,{method:"post",data:{accessToken:e.getStorageSync("accessToken"),list:[{cur:t.inquiryForm.currency,price:t.inquiryForm.price,deliveryDay:t.inquiryForm.day,expiredDate:t.inquiryForm.validity,spuId:t.commodityInfo.spuId,spuName:t.commodityInfo.spuName,skuId:t.commodityInfo.skuId,spuSpec:t.commodityInfo.spuSpec,unit:t.commodityInfo.unit}]}});case 3:o=n.sent,t.inquiryShow=!1,"0"===o.data.code?(t.$refs.toast.show({title:"提交报价成功",type:"success",position:"top"}),t.getSupplierProduct()):t.$refs.toast.show({title:"提交报价失败",type:"error",position:"top"});case 6:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}());case 1:case"end":return n.stop()}}),n)})))()},resetInquiryForm:function(){this.inquiryForm={currency:"",price:"",validity:"",day:"",trend:"",pricetrendValue:"",explain:"",remark:""},this.$refs["iForm1"].resetFields()},showTrendSelect:function(){this.selectPriceTrendShow=!0},confirmPriceTrend:function(e){this.inquiryForm.trend=e[0].label,this.inquiryForm.pricetrendValue=e[0].value},showCurrencySelect:function(){this.selectTypesCurrencyShow=!0},confirmCurrency:function(e){this.inquiryForm.currency=e[0].label}},a(i,"confirmPriceTrend",(function(e){this.inquiryForm.trend=e[0].label,this.inquiryForm.pricetrendValue=e[0].value})),a(i,"confirmTime",(function(e){this.inquiryForm.validity="".concat(e.year,"-").concat(e.month,"-").concat(e.day," ").concat(e.hour,":").concat(e.minute)})),a(i,"showValidity",(function(){this.dateTime=!0})),a(i,"submitSomeBidding",(function(){var t=this;return d(u.default.mark((function n(){var i,o;return u.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return i=[],t.checkedList.forEach((function(e){var n={cur:e.currency,price:e.price,deliveryDay:t.inquiryForm.day,expiredDate:t.inquiryForm.validity,spuId:e.spuId,spuName:e.spuName,skuId:e.skuId,spuSpec:e.spuSpec,unit:e.unit};i.push(n)})),n.next=4,(0,r.default)(t.api.v2.submitProduct,{method:"post",data:{accessToken:e.getStorageSync("accessToken"),list:i}});case 4:o=n.sent,"0"===o.data.code?(t.$refs.toast.show({title:"提交报价成功",type:"success",position:"top"}),t.getSupplierProduct()):t.$refs.toast.show({title:"提交报价失败",type:"error",position:"top"});case 6:case"end":return n.stop()}}),n)})))()})),i),computed:{day3AfterList:function(){var e=this;return this.list.filter((function(t){return(new Date).valueOf()<new Date(t.expiredDate).getTime()&&new Date(t.expiredDate).getTime()<e.day3After}))}}};t.default=f}).call(this,n("543d")["default"])},"7fbb":function(e,t,n){"use strict";n.r(t);var i=n("2997"),u=n.n(i);for(var r in i)"default"!==r&&function(e){n.d(t,e,(function(){return i[e]}))}(r);t["default"]=u.a},"80ed":function(e,t,n){"use strict";n.r(t);var i=n("a2b5"),u=n("7fbb");for(var r in u)"default"!==r&&function(e){n.d(t,e,(function(){return u[e]}))}(r);n("8ee2");var o,c=n("f0c5"),a=Object(c["a"])(u["default"],i["b"],i["c"],!1,null,"0700a31e",null,!1,i["a"],o);t["default"]=a.exports},"8ee2":function(e,t,n){"use strict";var i=n("0eca"),u=n.n(i);u.a},a2b5:function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return i}));var i={uCheckbox:function(){return n.e("node-modules/uview-ui/components/u-checkbox/u-checkbox").then(n.bind(null,"8fb5"))},uField:function(){return n.e("node-modules/uview-ui/components/u-field/u-field").then(n.bind(null,"b871"))},uButton:function(){return n.e("node-modules/uview-ui/components/u-button/u-button").then(n.bind(null,"50a4"))},uCheckboxGroup:function(){return Promise.all([n.e("common/vendor"),n.e("node-modules/uview-ui/components/u-checkbox-group/u-checkbox-group")]).then(n.bind(null,"d313"))},uTag:function(){return n.e("node-modules/uview-ui/components/u-tag/u-tag").then(n.bind(null,"c6fc"))},uInput:function(){return Promise.all([n.e("common/vendor"),n.e("node-modules/uview-ui/components/u-input/u-input")]).then(n.bind(null,"8497"))},uModal:function(){return n.e("node-modules/uview-ui/components/u-modal/u-modal").then(n.bind(null,"06da"))},uForm:function(){return n.e("node-modules/uview-ui/components/u-form/u-form").then(n.bind(null,"cd3f"))},uFormItem:function(){return Promise.all([n.e("common/vendor"),n.e("node-modules/uview-ui/components/u-form-item/u-form-item")]).then(n.bind(null,"1dea"))},uRow:function(){return n.e("node-modules/uview-ui/components/u-row/u-row").then(n.bind(null,"3878"))},uCol:function(){return n.e("node-modules/uview-ui/components/u-col/u-col").then(n.bind(null,"26b8"))},uSelect:function(){return n.e("node-modules/uview-ui/components/u-select/u-select").then(n.bind(null,"8733"))},uPicker:function(){return Promise.all([n.e("common/vendor"),n.e("node-modules/uview-ui/components/u-picker/u-picker")]).then(n.bind(null,"3215"))},uToast:function(){return n.e("node-modules/uview-ui/components/u-toast/u-toast").then(n.bind(null,"da1a"))}},u=function(){var e=this,t=e.$createElement;e._self._c},r=[]},c2bc:function(e,t,n){"use strict";(function(e){n("a70e");i(n("66fd"));var t=i(n("80ed"));function i(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,n("543d")["createPage"])}},[["c2bc","common/runtime","common/vendor"]]]);